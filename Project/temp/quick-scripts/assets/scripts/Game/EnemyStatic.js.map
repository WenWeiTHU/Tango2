{"version":3,"sources":["EnemyStatic.js"],"names":["cc","Class","extends","require","properties","shootNum","BulletPrefab","type","Prefab","default","bulletSpeed","onLoad","director","getCollisionManager","enabled","onCollisionEnter","other","self","node","group","i","newBullet","instantiate","bulletSetting","getComponent","rotation","x","y","direction","v2","Math","cos","PI","sin","speed","parent","addChild","explode","Explode","play","blast","BlastPrefab","setPosition","animComponent","Animation","destroy","sortAllChildren","start","update","dt","rotate"],"mappings":";;;;;;AAAA;;;;AAIAA,GAAGC,KAAH,CAAS;AACPC,WAASC,QAAQ,OAAR,CADF;;AAGPC,cAAY;AACVC,cAAU,CADA,EACG;AACbC,kBAAc;AACZC,YAAMP,GAAGQ,MADG;AAEZC,eAAS;AAFG,KAFJ;AAMVC,iBAAa,EANH,CAMM;AANN,GAHL;;AAYP;;AAEA;;;;AAIAC,QAlBO,oBAkBG;AACR;AACAX,OAAGY,QAAH,CAAYC,mBAAZ,GAAkCC,OAAlC,GAA4C,IAA5C;AACD,GArBM;;;AAuBP;;;;AAIAC,kBA3BO,4BA2BWC,KA3BX,EA2BkBC,IA3BlB,EA2BwB;AAC7B,QAAID,MAAME,IAAN,CAAWC,KAAX,KAAqB,MAArB,IAA+BH,MAAME,IAAN,CAAWC,KAAX,KAAqB,QAApD,IAAgEH,MAAME,IAAN,CAAWC,KAAX,KAAqB,QAAzF,EAAmG;AACjG;AACA,WAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAI,GAApB,EAAyBA,KAAK,MAAM,KAAKf,QAAzC,EAAmD;AACjD;AACA,YAAMgB,YAAYrB,GAAGsB,WAAH,CAAe,KAAKhB,YAApB,CAAlB;AACA,YAAMiB,gBAAgBF,UAAUG,YAAV,CAAuB,QAAvB,CAAtB;;AAEAH,kBAAUI,QAAV,GAAqB,KAAKL,CAA1B;;AAEAC,kBAAUK,CAAV,GAAc,KAAKR,IAAL,CAAUQ,CAAxB;AACAL,kBAAUM,CAAV,GAAc,KAAKT,IAAL,CAAUS,CAAxB;AACAJ,sBAAcK,SAAd,GAA0B5B,GAAG6B,EAAH,CAAMC,KAAKC,GAAL,CAASX,IAAIU,KAAKE,EAAT,GAAc,GAAvB,CAAN,EAAmCF,KAAKG,GAAL,CAASb,IAAIU,KAAKE,EAAT,GAAc,GAAvB,CAAnC,CAA1B;AACAT,sBAAcW,KAAd,GAAsB,KAAKxB,WAA3B;;AAEA,aAAKQ,IAAL,CAAUiB,MAAV,CAAiBA,MAAjB,CAAwBC,QAAxB,CAAiCf,SAAjC;AACD;AACD,WAAKgB,OAAL;AACD;AACF,GA9CM;;;AAgDP;;;;AAIAA,SApDO,qBAoDI;AACT,SAAKC,OAAL,CAAaC,IAAb;AACA,QAAIC,QAAQxC,GAAGsB,WAAH,CAAe,KAAKmB,WAApB,CAAZ;;AAEA,SAAKvB,IAAL,CAAUiB,MAAV,CAAiBC,QAAjB,CAA0BI,KAA1B;AACAA,UAAME,WAAN,CAAkB,KAAKxB,IAAL,CAAUQ,CAA5B,EAA+B,KAAKR,IAAL,CAAUS,CAAzC;;AAEA,QAAIgB,gBAAgBH,MAAMhB,YAAN,CAAmBxB,GAAG4C,SAAtB,CAApB;AACAD,kBAAcJ,IAAd,CAAmB,QAAnB;;AAEA,SAAKrB,IAAL,CAAU2B,OAAV;AACA,SAAK3B,IAAL,CAAUiB,MAAV,CAAiBW,eAAjB;AACD,GAhEM;AAkEPC,OAlEO,mBAkEE,CAAE,CAlEJ;;;AAoEP;AACAC,QArEO,kBAqECC,EArED,EAqEK;AACV,SAAKC,MAAL;AACD;AAvEM,CAAT","file":"EnemyStatic.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\Game","sourcesContent":["/*\n * 静态自爆型敌人脚本\n */\n\ncc.Class({\n  extends: require('Enemy'),\n\n  properties: {\n    shootNum: 8, // 自爆时子弹发射数\n    BulletPrefab: {\n      type: cc.Prefab,\n      default: null\n    },\n    bulletSpeed: 60 // 子弹射速\n  },\n\n  // LIFE-CYCLE CALLBACKS:\n\n  /*\n     * 初始化函数\n     * 功能：初始化脚本运行所需的设定\n     */\n  onLoad () {\n    // 开启碰撞检测\n    cc.director.getCollisionManager().enabled = true\n  },\n\n  /*\n     * 碰撞函数\n     * 功能：对象被碰撞时调用此函数\n     */\n  onCollisionEnter (other, self) {\n    if (other.node.group === 'Bind' || other.node.group === 'Player' || other.node.group === 'Shield') {\n      // 如果被链接、主角或者护盾撞击，则该对象发生爆炸\n      for (let i = 0; i < 360; i += 360 / this.shootNum) {\n        // 构造新子弹，并设置参数\n        const newBullet = cc.instantiate(this.BulletPrefab)\n        const bulletSetting = newBullet.getComponent('Bullet')\n\n        newBullet.rotation = 90 - i\n\n        newBullet.x = this.node.x\n        newBullet.y = this.node.y\n        bulletSetting.direction = cc.v2(Math.cos(i * Math.PI / 180), Math.sin(i * Math.PI / 180))\n        bulletSetting.speed = this.bulletSpeed\n\n        this.node.parent.parent.addChild(newBullet)\n      }\n      this.explode()\n    }\n  },\n\n  /*\n     * 爆炸函数\n     * 功能：产生爆炸动画并销毁自身\n     */\n  explode () {\n    this.Explode.play()\n    var blast = cc.instantiate(this.BlastPrefab)\n\n    this.node.parent.addChild(blast)\n    blast.setPosition(this.node.x, this.node.y)\n\n    var animComponent = blast.getComponent(cc.Animation)\n    animComponent.play('blast3')\n\n    this.node.destroy()\n    this.node.parent.sortAllChildren()\n  },\n\n  start () {},\n\n  // 系统调用的更新函数\n  update (dt) {\n    this.rotate()\n  }\n})\n"]}