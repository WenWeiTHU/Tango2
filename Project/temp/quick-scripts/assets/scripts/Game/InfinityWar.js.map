{"version":3,"sources":["InfinityWar.js"],"names":["cc","Class","extends","Component","properties","Player1","type","Node","default","Player2","SupplyPrefab","Prefab","PauseMenuPrefab","ShieldSupplyPrefab","EnemyPrefab","StaticEnemyPrefab","TrackEnemyPrefab","SpinEnemyPrefab","SwingEnemyPrefab","CopterEnemyPrefab","BatteryPrefab","BulletPrefab","MapVPrefab","MapHPrefab","Explode","AudioSource","TimeLabel","Label","pauseBtn","Button","MainCamera","Camera","Width","Height","borderSize","stateChange","getRandomPosition","maxX","randX","Math","random","maxY","randY","v2","generate","posX","posY","name","thing","instantiate","getComponent","Player","centerX","centerY","node","getChildByName","addChild","setPosition","onLoad","i","children","length","zIndex","sortAllChildren","on","pauseScene","start","time","scheduleOnce","initGame","schedule","updateTime","pause","string","SupplyHelp","EnemyAttack","StaticEnemyAttack","TrackEnemyAttack","SpinEnemyAttack","BatteryPowerUp","CopterEnemyAttack","SwingEnemyAttack","BatteryAdd","child","active","grandSon","group","exist","timeID","clearTimeout","undefined","setTimeout","bind","Menu","x","y","pos","speedX","speedY","dir","targetposX","targetposY","num","duration","targetPosX","targetPosY","swingDuration","posx","posy","Battery","shootNum","GameOver","end","sys","localStorage","setItem","String","result","getItem","scores","JSON","parse","push","score","Date","now","sort","a","b","stringify","zoomRatio","sceneName","director","_loadingScene","loadScene","update","dt","Dead"],"mappings":"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","file":"InfinityWar.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\Game","sourcesContent":["/*\n * 生存模式控制脚本\n */\n\ncc.Class({\n  extends: cc.Component,\n\n  properties: {\n    Player1: {\n      type: cc.Node,\n      default: null\n    },\n    Player2: {\n      type: cc.Node,\n      default: null\n    },\n    SupplyPrefab: {\n      default: null,\n      type: cc.Prefab\n    },\n    PauseMenuPrefab: {\n      default: null,\n      type: cc.Prefab\n    },\n    ShieldSupplyPrefab: {\n      default: null,\n      type: cc.Prefab\n    },\n    EnemyPrefab: {\n      type: cc.Prefab,\n      default: null\n    },\n    StaticEnemyPrefab: {\n      type: cc.Prefab,\n      default: null\n    },\n    TrackEnemyPrefab: {\n      type: cc.Prefab,\n      default: null\n    },\n    SpinEnemyPrefab: {\n      type: cc.Prefab,\n      default: null\n    },\n    SwingEnemyPrefab: {\n      type: cc.Prefab,\n      default: null\n    },\n    CopterEnemyPrefab: {\n      type: cc.Prefab,\n      default: null\n    },\n    BatteryPrefab: {\n      type: cc.Prefab,\n      default: null\n    },\n    BulletPrefab: {\n      type: cc.Prefab,\n      default: null\n    },\n    MapVPrefab: {\n      type: cc.Prefab,\n      default: null\n    },\n    MapHPrefab: {\n      type: cc.Prefab,\n      default: null\n    },\n    Explode: {\n      type: cc.AudioSource,\n      default: null\n    },\n    TimeLabel: {\n      type: cc.Label,\n      default: null\n    },\n    pauseBtn: {\n      type: cc.Button,\n      default: null\n    },\n    MainCamera: {\n      type: cc.Camera,\n      default: null\n    },\n    Width: 2500, // 地图宽度\n    Height: 2500, // 地图高度\n    borderSize: 45, // 边界(防止随机产生时越墙)\n    stateChange: false // 暂停状态记录\n  },\n\n  /*\n     * 获取随机位置函数\n     * 功能：获取一个随机的位置\n     */\n  getRandomPosition: function () {\n    var maxX = this.Width / 2 - this.borderSize\n    var randX = (Math.random() - 0.5) * 2 * maxX\n    var maxY = this.Height / 2 - this.borderSize\n    var randY = (Math.random() - 0.5) * 2 * maxY\n\n    return cc.v2(randX, randY)\n  },\n\n  /*\n     * 生成函数\n     * 功能：根据参数生成一个对象，是敌人或者补给或者其他\n     */\n  generate (posX, posY, name) {\n    let thing\n\n    // 根据参数名生成敌机类型,并初始化其参数\n    switch (name) {\n      case 'enemy':\n        thing = cc.instantiate(this.EnemyPrefab)\n        thing.getComponent('Enemy').Explode = this.Explode\n        break\n      case 'staticEnemy':\n        thing = cc.instantiate(this.StaticEnemyPrefab)\n        thing.getComponent('EnemyStatic').Explode = this.Explode\n        break\n      case 'trackEnemy':\n        thing = cc.instantiate(this.TrackEnemyPrefab)\n        thing.getComponent('EnemyTrack').Explode = this.Explode\n        thing.getComponent('EnemyTrack').Player = Math.random() < 0.5 ? this.Player1 : this.Player2\n        break\n      case 'spinEnemy':\n        thing = cc.instantiate(this.SpinEnemyPrefab)\n        thing.getComponent('EnemySpin').Explode = this.Explode\n        thing.getComponent('EnemySpin').centerX = posX\n        thing.getComponent('EnemySpin').centerY = posY\n\n        thing.getComponent('EnemySpin').Player = Math.random() < 0.5 ? this.Player1 : this.Player2\n        break\n      case 'swingEnemy':\n        thing = cc.instantiate(this.SwingEnemyPrefab)\n        thing.getComponent('EnemySwing').Explode = this.Explode\n        break\n      case 'copterEnemy':\n        thing = cc.instantiate(this.CopterEnemyPrefab)\n        thing.getComponent('EnemyCopter').BulletPrefab = this.BulletPrefab\n        thing.getComponent('EnemyCopter').Explode = this.Explode\n\n        thing.getComponent('EnemySpin').centerX = posX\n        thing.getComponent('EnemySpin').centerY = posY\n\n        thing.getComponent('EnemyCopter').Player = Math.random() < 0.5 ? this.Player1 : this.Player2\n        break\n      case 'supply':\n        thing = cc.instantiate(this.SupplyPrefab)\n        break\n      case 'shieldSupply':\n        thing = cc.instantiate(this.ShieldSupplyPrefab)\n        break\n      case 'battery':\n        thing = cc.instantiate(this.BatteryPrefab)\n        thing.getComponent('Battery').Player1 = this.Player1\n        thing.getComponent('Battery').Player2 = this.Player2\n        thing.getComponent('Battery').BulletPrefab = this.BulletPrefab\n        break\n    }\n    if (name === 'battery') {\n      this.node.getChildByName('Map').addChild(thing)\n    } else {\n      this.node.getChildByName('Enemy').addChild(thing)\n    }\n    thing.setPosition(posX, posY)\n    return thing\n  },\n\n  /*\n     * 初始化函数\n     * 功能：初始化脚本所需的设定\n     */\n  onLoad () {\n    // 设置对象的zIndex，保证显示层级的正确\n    for (var i = 0; i < this.node.children.length; ++i) {\n      switch (this.node.children[i].name) {\n        case 'player1': {\n          this.node.children[i].zIndex = 100\n          break\n        }\n        case 'player2': {\n          this.node.children[i].zIndex = 100\n          break\n        }\n        case 'stickLeft':\n        case 'stickRight': {\n          this.node.children[i].zIndex = 101\n          break\n        }\n        case 'bg': {\n          this.node.children[i].zIndex = -100\n          break\n        }\n      }\n    }\n    this.node.sortAllChildren()\n\n    // 绑定暂停按键的回调函数\n    this.pauseBtn.node.on('click', this.pauseScene, this)\n  },\n\n  start () {\n    this.time = 0\n    this.scheduleOnce(this.initGame, 0)\n    this.schedule(this.updateTime, 1)\n  },\n\n  updateTime: function () {\n    if (this.pause) {\n      return\n    }\n    this.time += 1\n    this.TimeLabel.string = 'Time: ' + this.time + 's'\n  },\n\n  /*\n     * 初始化游戏场景函数\n     * 功能：初始化游戏场景，生成一些敌人，\n     *      并且设置定时生成敌人的时间\n     */\n  initGame: function () {\n    this.generate(-500, 500, 'enemy')\n    this.generate(500, 500, 'enemy')\n    this.generate(500, -500, 'enemy')\n    this.generate(-500, -500, 'enemy')\n\n    this.generate(0, 0, 'supply')\n\n    this.SupplyHelp(20)\n\n    this.EnemyAttack(8)\n\n    this.scheduleOnce(() => {\n      this.StaticEnemyAttack(20)\n    }, 2)\n\n    this.scheduleOnce(() => {\n      this.TrackEnemyAttack(12)\n    }, 10)\n\n    this.scheduleOnce(() => {\n      this.SpinEnemyAttack(13)\n    }, 20)\n\n    this.scheduleOnce(() => {\n      this.BatteryPowerUp(0, 0, 30)\n    }, 45)\n\n    this.scheduleOnce(() => {\n      this.CopterEnemyAttack(15)\n    }, 60)\n\n    this.scheduleOnce(() => {\n      this.SwingEnemyAttack('x', 2200, 0, 10, 6)\n    }, 80)\n\n    this.scheduleOnce(() => {\n      this.SwingEnemyAttack('y', 0, 2200, 10, 6)\n    }, 100)\n\n    this.scheduleOnce(() => {\n      this.BatteryAdd(60)\n    }, 120)\n\n    this.scheduleOnce(() => {\n      this.SwingEnemyAttack('x', 1100, 1100, 20, 6)\n    }, 300)\n\n    this.scheduleOnce(() => {\n      this.SwingEnemyAttack('y', -1100, 1100, 20, 6)\n    }, 330)\n  },\n\n  /*\n     * 暂停场景函数\n     * 功能：暂停/恢复场景内容\n     */\n  pauseScene () {\n    // 遍历Canvas的每一个子节点，将其设为活跃/不活跃状态\n    for (var child of this.node.children) {\n      switch (child.name) {\n        case 'Enemy':\n        case 'Map':\n        case 'player1':\n        case 'player2':\n        case 'bullet':\n        case 'bind':\n        case 'target': {\n          // 普通对象直接根据暂停还是恢复来设置活跃状态\n          child.active = this.pause\n          break\n        }\n        /*\n          * 以下函数有些繁琐，目的是为了记录护盾对象\n          * 的存在状态，并在恢复时进行恢复。同时，由于\n          * 护盾本身存在寿命，所以我们对恢复后的寿命给\n          * 出一个统计的平均数——2.5s\n          */\n        case 'UI': {\n          for (var grandSon of child.children) {\n            if (grandSon.group !== 'Shield') {\n              grandSon.active = this.pause\n            } else {\n              if (!this.pause) {\n                grandSon.exist = grandSon.active\n                grandSon.active = false\n                if (grandSon.timeID) {\n                  clearTimeout(grandSon.timeID)\n                  grandSon.timeID = undefined\n                }\n              } else {\n                grandSon.active = grandSon.exist\n                grandSon.exist = false\n                if (grandSon.active) {\n                  if (grandSon.name === 'shieldLeft') {\n                    grandSon.timeID = setTimeout(function () {\n                      this.active = false\n                    }.bind(this.node.getChildByName('UI').getChildByName('shieldLeft')), 2500)\n                  } else {\n                    grandSon.timeID = setTimeout(function () {\n                      this.active = false\n                    }.bind(this.node.getChildByName('UI').getChildByName('shieldRight')), 2500)\n                  }\n                }\n              }\n            }\n          }\n          break\n        }\n      }\n    }\n\n    // 修改场景的暂停状态\n    this.pause = !this.pause\n\n    // 如果当前操作是要暂停此场景\n    // 则要显示一个暂停菜单\n    if (this.pause) {\n      var Menu = cc.instantiate(this.PauseMenuPrefab)\n      Menu.x = 0\n      Menu.y = 0\n      Menu.group = 'UI'\n      this.node.getChildByName('UI').active = true\n      this.node.getChildByName('UI').addChild(Menu)\n    }\n  },\n\n  /*\n     * 定时生成enemy\n     * 功能：根据给定的时间间隔，生成2个普通的enemy\n     * 位置，速度随机\n     */\n  EnemyAttack: function (time) {\n    this.schedule(() => {\n      for (let i = 0; i < 2; i++) {\n        const pos = this.getRandomPosition()\n        const thing = this.generate(pos.x, pos.y, 'enemy').getComponent('Enemy')\n        thing.speedX = 400 * (Math.random() - 0.5)\n        thing.speedY = 400 * (Math.random() - 0.5)\n      }\n    }, time)\n  },\n\n  /*\n     * 生成静态敌人函数\n     * 功能：根据给定的时间间隔，生成静态敌人\n     */\n  StaticEnemyAttack (time) {\n    this.schedule(() => {\n      const pos = this.getRandomPosition()\n      this.generate(pos.x, pos.y, 'staticEnemy')\n    }, time)\n  },\n\n  /*\n     * 生成追踪敌人函数\n     * 功能：根据给定的时间间隔，生成追踪型敌人\n     */\n  TrackEnemyAttack (time) {\n    this.schedule(() => {\n      for (let i = 0; i < 2; i++) {\n        const pos = this.getRandomPosition()\n        this.generate(pos.x, pos.y, 'trackEnemy')\n      }\n    }, time)\n  },\n\n  /*\n     * 生成旋转敌人函数\n     * 功能：根据给定的时间间隔，生成旋转型敌人\n     */\n  SpinEnemyAttack (time) {\n    this.schedule(() => {\n      this.generate(this.Player1.x, this.Player1.y, 'spinEnemy')\n      this.generate(this.Player2.x, this.Player2.y, 'spinEnemy')\n    }, time)\n  },\n\n  /*\n     * 直升机敌人生成函数\n     * 功能：根据给定的时间间隔，生成直升机敌人\n     */\n  CopterEnemyAttack (time) {\n    this.schedule(() => {\n      this.generate(this.Player1.x, this.Player1.y, 'copterEnemy')\n      this.generate(this.Player2.x, this.Player2.y, 'copterEnemy')\n    }, time)\n  },\n\n  /*\n     * 生成往返敌人函数\n     * 功能：根据给定的参数和时间间隔，生成往返敌人\n     */\n  SwingEnemyAttack (dir, targetposX, targetposY, num, duration) {\n    this.scheduleOnce(() => {\n      for (let i = -1100; i < 1100; i += 2200 / (num - 1)) {\n        let thing\n        if (dir === 'x') {\n          thing = this.generate(-1100, i, 'swingEnemy').getComponent('EnemySwing')\n        } else if (dir === 'y') {\n          thing = this.generate(i, -1100, 'swingEnemy').getComponent('EnemySwing')\n        }\n\n        thing.targetPosX = targetposX\n        thing.targetPosY = targetposY\n        thing.swingDuration = duration\n      }\n    }, 0)\n  },\n\n  /*\n     * 生成补给函数\n     * 功能：根据给定的时间间隔产生补给\n     */\n  SupplyHelp: function (time) {\n    this.schedule(() => {\n      const pos = this.getRandomPosition()\n      const num = Math.random()\n      if (num > 0.5) {\n        this.generate(pos.x, pos.y, 'shieldSupply')\n      } else {\n        this.generate(pos.x, pos.y, 'supply')\n      }\n    }, time)\n  },\n\n  /*\n     * 生成炮台函数\n     * 功能：根据给定的时间间隔，生成炮台,数量会随时间增加\n     */\n  BatteryAdd: function (time) {\n    this.scheduleOnce(() => {\n      this.generate(1100, 1100, 'battery')\n      this.scheduleOnce(() => {\n        this.generate(1100, -1100, 'battery')\n        this.scheduleOnce(() => {\n          this.generate(-1100, -1100, 'battery')\n        }, time)\n      }, time)\n    }, time)\n  },\n\n  /*\n     * 生成炮台函数\n     * 功能：根据给定的时间间隔，生成炮台,火力会随时间增加\n     */\n  BatteryPowerUp: function (posx, posy, time) {\n    this.scheduleOnce(() => {\n      var Battery = this.generate(posx, posy, 'battery').getComponent('Battery')\n      Battery.shootNum = 1\n      this.scheduleOnce(() => {\n        Battery.shootNum = 2\n        this.scheduleOnce(() => {\n          Battery.shootNum = 3\n          this.scheduleOnce(() => {\n            Battery.shootNum = 4\n          }, time)\n        }, time)\n      }, time)\n    }, time)\n  },\n\n  /*\n     * 游戏结束函数\n     * 功能：向本地储存中写入游戏结果，并准备加载下一场景\n     */\n  GameOver () {\n    this.end = true\n    cc.sys.localStorage.setItem('SurviveScore', String(this.time))\n    var result = cc.sys.localStorage.getItem('highestScore')\n    var scores = cc.sys.localStorage.getItem('ranking')\n    scores = JSON.parse(scores)\n    scores.push({\n      score: this.time,\n      time: Date(Date.now())\n    })\n    scores.sort(function (a, b) {\n      return a.score > b.score ? -1 : 1\n    })\n    cc.sys.localStorage.setItem('ranking', JSON.stringify(scores))\n    if (this.time > result) {\n      cc.sys.localStorage.setItem('highestScore', this.time)\n    }\n    this.schedule(() => {\n      this.MainCamera.zoomRatio -= 0.004\n    }, 0.001)\n\n    this.scheduleOnce(() => {\n      var sceneName = cc.director._loadingScene\n      if (sceneName !== 'Transition_INF') {\n        cc.director.loadScene('Transition_INF')\n      }\n    }, 2)\n  },\n\n  // 系统调用的更新函数\n  update (dt) {\n    if (this.stateChange && !this.end) {\n      this.pauseScene()\n      this.stateChange = false\n    }\n\n    if (this.Player1.getComponent('Player').Dead && !this.end) {\n      this.GameOver()\n    }\n    if (this.Player2.getComponent('Player').Dead && !this.end) {\n      this.GameOver()\n    }\n  }\n})\n"]}